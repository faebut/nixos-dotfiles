# imports
source=./themes/rose-pine-moon.conf

# See https://wiki.hyprland.org/Configuring/Monitors/
monitor=eDP-1,preferred,0x0,1.25
# monitor=DP-4,preferred,auto-right,1.666

# Set programs that you use
$terminal = kitty
$mail = thunderbird
$browser = firefox
$fileManager = nautilus -w
$menu = ~/.config/rofi/scripts/launcher.sh
$powermenu = ~/.config/rofi/scripts/powermenu.sh

# # unscale XWayland
xwayland {
  force_zero_scaling = true
}
#
# # toolkit-specific scale
env = GDK_SCALE,2

## electron for wayland
env = ELECTRON_OZONE_PLATFORM_HINT,wayland

# See https://wiki.hyprland.org/Configuring/Keywords/ for more

# Execute your favorite apps at launch
exec-once = ~/.config/hypr/scripts/xdg-portal-hyprland.sh # Make sure the correct portal is running
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP # Wayland magic (screen sharing etc.)
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP # More wayland magic (screen sharing etc.)
# exec-once = /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 # used for user sudo graphical elevation
exec-once = systemctl --user start hyprpolkitagent # used for user sudo graphical elevation
# cursor settings
env = XCURSOR_THEME,Hackneyed-Dark
env = XCURSOR_SIZE,48
exec-once = gsettings set org.gnome.desktop.interface cursor-theme 'Hackneyed-Dark'
exec-once = gsettings set org.gnome.desktop.interface cursor-size '48'
exec-once = hyprctl setcursor Hackneyed-Dark 48 

# Theme
exec = gsettings set org.gnome.desktop.interface color-scheme "prefer-dark"   # for GTK4 apps
env = QT_QPA_PLATFORMTHEME,qt6ct   # for Qt apps

# Other tools
exec-once = ~/.config/waybar/launch.sh # The top bar
exec-once = hyprpaper # Background
# history file
exec-once = wl-paste --type text --watch cliphist store #clip setup
exec-once = wl-paste --type image --watch cliphist store #clip setup
exec-once = pypr
exec-once = hypridle
exec-once = nm-applet --indicator 
exec-once = [workspace 9 silent; monitor eDP-1] sleep 5 & $mail
exec-once = [workspace 2 silent; monitor eDP-1] $browser
exec-once = [workspace 1; monitor eDP-1] $terminal

# exec-once = gBar bar 0
# exec = udiskie & #automount tool
# TODO: check if swaync can be deleted
# exec = swaync #notification daemon

# Startup applications
exec-once = ferdium
exec-once = slack -u
exec-once = filen-desktop

# Source a file (multi-file configs)
# source = ~/.config/hypr/myColors.conf


# For all categories, see https://wiki.hyprland.org/Configuring/Variables/
input {
    kb_layout = ch
    kb_variant =
    kb_model =
    kb_options =
    kb_rules = 
    repeat_delay = 500

    follow_mouse = 1

    touchpad {
        natural_scroll = true
        disable_while_typing = yes
        clickfinger_behavior = true
    }

    sensitivity = 0.1 # -1.0 - 1.0, 0 means no modification.
}

general {
    # See https://wiki.hyprland.org/Configuring/Variables/ for more

    gaps_in = 6
    gaps_out = 12
    border_size = 1
    col.active_border = $rose $iris 90deg
    col.inactive_border = $muted

    layout = dwindle
    resize_on_border = true

    # Please see https://wiki.hyprland.org/Configuring/Tearing/ before you turn this on
    allow_tearing = false
    extend_border_grab_area = 20
}

decoration {
    # See https://wiki.hyprland.org/Configuring/Variables/ for more

    # rounding = 5
    inactive_opacity = 0.8

    blur {
        enabled = true
        size = 5
        passes = 3
     ignore_opacity = true    
        vibrancy = 0.1696
    }

shadow {
    range = 8
    render_power = 3
    color = rgba(1a1a1aee)
  }
}

animations {
    enabled = true

    # Some default animations, see https://wiki.hyprland.org/Configuring/Animations/ for more

    bezier = myBezier, 0.05, 0.9, 0.1, 1.05

    animation = windows, 1, 3, myBezier
    animation = windowsOut, 1, 3, default, popin 80%
    animation = border, 1, 5, default
    animation = borderangle, 1, 3, default
    animation = fade, 1, 3, default
    animation = workspaces, 1, 3, myBezier
}

dwindle {
    # See https://wiki.hyprland.org/Configuring/Dwindle-Layout/ for more
    pseudotile = true # master switch for pseudotiling. Enabling is bound to mainMod + P in the keybinds section below
    preserve_split = true # you probably want this
}

gestures {
    # see https://wiki.hypr.land/Configuring/Gestures/
    gesture = 3, horizontal, workspace
}

misc {
    # See https://wiki.hyprland.org/Configuring/Variables/ for more
    force_default_wallpaper = 0 # Set to 0 or 1 to disable the anime mascot wallpapers
# try the cursor thingie
    # enable_hyprcursor = true
}

windowrulev2 = float,class:^(quickgui)$
windowrulev2 = float,class:^(amm_tool-dev-linux-amd64)$
windowrulev2 = float,class:^(org.gnome.Totem)$
windowrulev2 = float,class:^(MPlayer)$
windowrulev2 = float,class:^(QR-Rechnung)$
windowrule = float,title:^(update-sys)$
windowrule = size 40% 55%,title:^(update-sys)$
windowrule = size 50% 50%,title:^(Pick a File)$
windowrule = float,class:^(signal)$
windowrule = size 50% 50%,class:^(signal)$
# See https://wiki.hyprland.org/Configuring/Window-Rules/ for more
windowrule = float,class:^(blueman-manager)$
windowrule = size 30% 52%,class:^(blueman-manager)$
windowrule = float,class:^(nm-connection-editor)$
windowrule = float, title:^(Qalculate!)$
windowrule = float, title:^(Picture-in-Picture)$
windowrule = float, title:^(Media viewer)$
windowrule = float, title:^(fyne)$
# windowrule = tile,^(Chromium)$
# windowrule = tile,^(Postbird)$
windowrule = tile,class:^(ONLYOFFICE)$
windowrule = opacity 1 override 1 override,class:^(ONLYOFFICE)$
windowrule = tile,class:^(photo.exe)$
windowrule = opacity 1 override 1 override,class:^(photo.exe)$
windowrule = float,title:^(New Document)$
# make all floating windows a specific size and not take the full screen (didnt find a way to make this work)
# windowrulev2 = size 600 500,floating:1
# make the filemanager floating
windowrule = float,class:^(org.gnome.Nautilus)$
windowrule = size 45% 52%,class:^(org.gnome.Nautilus)$
# make the calculator floating
windowrule = float,class:^(org.gnome.Calculator)$
windowrule = size 20% 45%,class:^(org.gnome.Calculator)$
# make Ferdium floating
# windowrule = float, class:^(ferdium)$
# windowrule = size 60% 75%, class:^(ferdium)$
windowrule = float, class:^(xdg-desktop-portal-gtk)$

windowrulev2 = suppressevent maximize, class:.* # You'll probably like this.
windowrulev2 = opacity 1 1,title:^(nv)(.*)$
windowrule = size 45% 45%,title:^(Open File)$
windowrulev2 = opacity 1 override 1 override,class:^(firefox)$
windowrulev2 = opacity 1 override 1 override,class:^(zen)$
windowrulev2 = opacity 1 override 1 override,title:^(Windows11 on QEMU/KVM)$
windowrulev2 = bordercolor rgb(41a6b5),class:^(kitty-dropterm)$
windowrulev2 = bordercolor rgb(41a6b5),class:^(kitty-dropmc)$
windowrulev2 = bordercolor rgb(41a6b5),class:^(org.pulseaudio.pavucontrol)$
windowrulev2 = bordercolor rgb(41a6b5),class:^(kitty-spotify)$

# See https://wiki.hyprland.org/Configuring/Keywords/ for more
$mainMod = SUPER

# Example binds, see https://wiki.hyprland.org/Configuring/Binds/ for more
bind = $mainMod, T, exec, $terminal # open the terminal
bind = $mainMod SHIFT, T, exec, $terminal --hold tmux # open terminal with tmux session
bind = $mainMod, Q, killactive, # close the active window
bind = $mainMod SHIFT, Q, exec, hyprctl kill #xkill kill mode
bind = $mainMod, P, exec, $powermenu # show the logout window
bind = $mainMod, E, exec, $fileManager # Show the graphical file browser
bind = $mainMod SHIFT, F, togglefloating, # Allow a window to float
# bind = $mainMod, SPACE, exec, fuzzel -l 25# Show the graphical app launcher
bind = $mainMod, SPACE, exec, $menu  # Show wofi
bind = $mainMod, F, fullscreen, # fullscreen
bind = , Print, exec, grim -g "$(slurp)" # Screenshots
bind = $mainMod ALT, S, exec, hyprpicker -f hex -a -r
# bind = $mainMod SHIFT, V, exec, cliphist list | fuzzel -d -l 20 -w 100 | cliphist decode | wl-copy 
bind = $mainMod SHIFT, V, exec, rofi -modi clipboard:~/.config/rofi/scripts/clipboard -show clipboard -show-icons 
bind = $mainMod, B, exec, zen-browser

# Move focus with mainMod + arrow keys
bind = $mainMod, h, movefocus, l
bind = $mainMod, l, movefocus, r
bind = $mainMod, k, movefocus, u
bind = $mainMod, j, movefocus, d

# Change focused workspace
bind = $mainMod CONTROL, l, workspace, r+1
bind = $mainMod CONTROL, h, workspace, r-1
bind = $mainMod, Tab, workspace,previous

# resize windows 
binde = $mainMod ALT, right, resizeactive, 40 0
binde = $mainMod ALT, left, resizeactive, -40 0
binde = $mainMod ALT, down, resizeactive, 0 40
binde = $mainMod ALT, up, resizeactive, 0 -40

# Swap
bind = $mainMod SHIFT, x, swapnext
bind = $mainMod SHIFT, x, cyclenext
bind = $mainMod CONTROL SHIFT, x, layoutmsg, orientationtop

# Switch workspaces with mainMod + [0-9]
bind = $mainMod, 1, workspace, 1
bind = $mainMod, 2, workspace, 2
bind = $mainMod, 3, workspace, 3
bind = $mainMod, 4, workspace, 4
bind = $mainMod, 5, workspace, 5
bind = $mainMod, 6, workspace, 6
bind = $mainMod, 7, workspace, 7
bind = $mainMod, 8, workspace, 8
bind = $mainMod, 9, workspace, 9
bind = $mainMod, 0, workspace, 10

# Move active window to a workspace with mainMod + SHIFT + [0-9]
bind = $mainMod SHIFT CONTROL, l, movetoworkspace, r+1
bind = $mainMod SHIFT CONTROL, h, movetoworkspace, r-1
bind = $mainMod SHIFT, 1, movetoworkspace, 1
bind = $mainMod SHIFT, 2, movetoworkspace, 2
bind = $mainMod SHIFT, 3, movetoworkspace, 3
bind = $mainMod SHIFT, 4, movetoworkspace, 4
bind = $mainMod SHIFT, 5, movetoworkspace, 5
bind = $mainMod SHIFT, 6, movetoworkspace, 6
bind = $mainMod SHIFT, 7, movetoworkspace, 7
bind = $mainMod SHIFT, 8, movetoworkspace, 8
bind = $mainMod SHIFT, 9, movetoworkspace, 9
bind = $mainMod SHIFT, 0, movetoworkspace, 10


# Scroll through existing workspaces with mainMod + scroll
bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up, workspace, e-1

# Move/resize windows with mainMod + LMB/RMB and dragging
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# Hardware Keys fn-row
# Brightness
binde= , XF86MonBrightnessUp, exec, ~/.config/hypr/scripts/brightness.sh --inc
binde= , XF86MonBrightnessDown, exec, ~/.config/hypr/scripts/brightness.sh --dec
# Speaker volume
binde= , XF86AudioRaiseVolume, exec, ~/.config/hypr/scripts/volume.sh --inc
binde= , XF86AudioLowerVolume, exec, ~/.config/hypr/scripts/volume.sh --dec
bind = , XF86AudioMute, exec, ~/.config/hypr/scripts/volume.sh --toggle
bind = , XF86AudioMicMute, exec, pamixer --default-source -t
# Mic volume
binde = $mainMod, XF86AudioRaiseVolume,exec, ~/.config/hypr/scripts/volume.sh --mic-inc
binde = $mainMod, XF86AudioLowerVolume,exec, ~/.config/hypr/scripts/volume.sh --mic-dec
bind = $mainMod, XF86AudioMute,exec, ~/.config/hypr/scripts/volume.sh --toggle-mic
# Media
bind = , XF86AudioPlay, exec, playerctl play-pause -a 
bind = $mainMod SHIFT, XF86AudioMute,exec, pulseaudio-equalizer toggle

# Specials

#Scratchpads
bind = $mainMod,V,exec,pypr toggle volume
windowrule = float,class:^(org.pulseaudio.pavucontrol)$

bind = $mainMod,A,exec,pypr toggle term
$dropterm  = class:^(kitty-dropterm)$
windowrule = float,$dropterm
# windowrule = workspace special silent,$dropterm
windowrulev2 = opacity 0.8 0.8,class:$dropterm

bind = $mainMod SHIFT,E,exec,pypr toggle mc
$dropmc  = class:^(kitty-dropmc)$
windowrule = float,$dropmc
# windowrule = workspace special silent,$dropmc
# windowrule = size 70% 70%,$dropmc
# windowrulev2 = opacity 0.8 0.8,class:$dropmc

bind = $mainMod,M,exec,pypr toggle spotify
windowrule = float,class:^(kitty-spotify)
# windowrule = workspace special silent,^(kitty-spotify)
# windowrule = size 60% 50%,^(kitty-spotify)
windowrulev2 = opacity 0.8 0.8,class:^(kitty-spotify)

#binds
bind = $mainMod, S, togglespecialworkspace, magic
bind = $mainMod SHIFT, S, movetoworkspace, special:magic
bind = $mainMod, 0, togglespecialworkspace #mostra logseq
# bind = $mainMod, W ,exec, pypr expose #modalit√† expose
# Just for config changes
bind = $mainMod SHIFT, I, exec, ~/.config/waybar/launch.sh

# Toggles for different switches. 
# Laptop Lid don't activate hyprlock, it should be started by hypridle before sleep
# bindl = , switch:Lid Switch, exec, hyprlock

# start other applications
bind = $mainMod, C, exec, gnome-calculator
